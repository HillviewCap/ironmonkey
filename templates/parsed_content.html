{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4">
    <h1 class="text-2xl font-bold mb-4">Parsed Content</h1>
    
    <div class="mb-4 flex justify-between items-center">
        <form action="{{ url_for('rss_manager.parsed_content') }}" method="get" class="flex items-center">
            <input type="text" name="search" value="{{ search_query }}" placeholder="Search..." class="border rounded-l px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-r hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">Search</button>
        </form>
        
        <div class="flex items-center">
            <label for="per_page" class="mr-2">Items per page:</label>
            <select id="per_page" name="per_page" onchange="this.form.submit()" class="border rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500">
                {% for option in per_page_options %}
                    <option value="{{ option }}" {% if option == per_page %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <div class="overflow-x-auto">
        <table class="w-full table-auto">
            <thead>
                <tr class="bg-gray-200">
                    <th class="px-2 py-2 w-1/4">Title</th>
                    <th class="px-2 py-2 w-1/4">Content</th>
                    <th class="px-2 py-2 w-1/4">URL</th>
                    <th class="px-2 py-2 w-1/4">Created At</th>
                </tr>
            </thead>
            <tbody>
                {% for post in posts %}
                <tr class="{% if loop.index % 2 == 0 %}bg-gray-100{% endif %}">
                    <td class="border px-2 py-2 truncate">{{ post.title[:50] }}</td>
                    <td class="border px-2 py-2 truncate">{{ post.content[:50] }}</td>
                    <td class="border px-2 py-2 truncate">
                        <a href="{{ post.url }}" class="text-blue-500 hover:underline" target="_blank">
                            {{ post.url[:50] }}
                        </a>
                    </td>
                    <td class="border px-2 py-2">{{ post.created_at.strftime('%Y-%m-%d') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="mt-4 flex justify-center">
        {% if pagination.has_prev %}
            <a href="{{ url_for('rss_manager.parsed_content', page=pagination.prev_num, per_page=per_page, search=search_query) }}" class="px-3 py-2 bg-blue-500 text-white rounded mr-2 hover:bg-blue-600">&laquo; Previous</a>
        {% endif %}
        
        {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
            {% if page_num %}
                {% if page_num != pagination.page %}
                    <a href="{{ url_for('rss_manager.parsed_content', page=page_num, per_page=per_page, search=search_query) }}" class="px-3 py-2 bg-gray-200 text-gray-700 rounded mr-2 hover:bg-gray-300">{{ page_num }}</a>
                {% else %}
                    <span class="px-3 py-2 bg-blue-500 text-white rounded mr-2">{{ page_num }}</span>
                {% endif %}
            {% else %}
                <span class="px-3 py-2">...</span>
            {% endif %}
        {% endfor %}
        
        {% if pagination.has_next %}
            <a href="{{ url_for('rss_manager.parsed_content', page=pagination.next_num, per_page=per_page, search=search_query) }}" class="px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next &raquo;</a>
        {% endif %}
    </div>
</div>
{% endblock %}

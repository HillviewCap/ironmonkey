{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6">Blog Posts</h1>
    
    <div class="mb-6 flex justify-end">
        <button id="clear-summaries-btn" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300">Clear All Summaries</button>
    </div>

    <div id="parsed-content-table" class="bg-white shadow-md rounded-lg overflow-hidden"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            new gridjs.Grid({
                columns: [
                    {
                        name: 'Title',
                        formatter: (cell, row) => gridjs.html(`<a href="/item/${row.cells[0].data}">${cell}</a>`)
                    },
                    'Description',
                    'Published Date'
                ],
                server: {
                    url: parsedContentUrl,
                    then: data => data.data.map(item => [item.id, item.title, item.description, item.pub_date])
                },
                pagination: {
                    limit: 10
                },
                search: true,
                sort: true
            }).render(document.getElementById('parsed-content-table'));
        });
    </script>

    <script src="{{ url_for('static', filename='js/node_modules/gridjs/dist/gridjs.umd.js') }}"></script>
    <link href="{{ url_for('static', filename='js/node_modules/gridjs/dist/theme/mermaid.min.css') }}" rel="stylesheet" />

    <script>
        const parsedContentUrl = "{{ url_for('parsed_content.get_parsed_content', feed_id=feed_id) }}";
        const summarizeContentUrl = "{{ url_for('parsed_content.summarize_content') }}";
        const clearAllSummariesUrl = "{{ url_for('parsed_content.clear_all_summaries') }}";
        const csrfToken = "{{ csrf_token() }}";
    </script>
    <script src="{{ url_for('static', filename='js/parsed_content.js') }}"></script>
</div>
{% endblock %}

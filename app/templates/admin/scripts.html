<script>
    document.addEventListener('DOMContentLoaded', function() {
        var showAddRSSForm = document.getElementById('showAddRSSForm');
        var showAddContentForm = document.getElementById('showAddContentForm');

        if (showAddRSSForm) {
            showAddRSSForm.addEventListener('click', function() {
                document.getElementById('addRSSForm').classList.toggle('hidden');
            });
        }

        if (showAddContentForm) {
            showAddContentForm.addEventListener('click', function() {
                document.getElementById('addContentForm').classList.toggle('hidden');
            });
        }

        // Add event listeners for delete buttons
        const deleteButtons = document.querySelectorAll('.delete-btn');
        deleteButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                const contentId = this.getAttribute('data-id');
                if (confirm('Are you sure you want to delete this content?')) {
                    fetch(`/delete_content/${contentId}`, {
                        method: 'POST',
                        headers: {
                            'X-CSRFToken': getCookie('csrf_token')
                        }
                    }).then(response => {
                        if (response.ok) {
                            // Remove the row from the table
                            const row = this.closest('tr');
                            row.remove();
                        } else {
                            alert('Error deleting content');
                        }
                    });
                }
            });
        });

        if (typeof initTableSort === 'function') {
            initTableSort('parsed-content-table');
        }
    });

    // Function to get CSRF token from cookies
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>
